"use strict";const input=document.querySelector(".js_input"),submitBtn=document.querySelector(".js_submit_Btn"),resetBtn=document.querySelector(".js_reset_Btn"),resultsList=document.querySelector(".js_results_list"),favoritesList=document.querySelector(".js_favorites_list"),apiURL="https://api.jikan.moe/v4/anime?q=",noImage="https://cdn.myanimelist.net/img/sp/icon/apple-touch-icon-256.png",placeholderImage="https://via.placeholder.com/225x200/ffffff/666666/?text=sin%20imagen%20%20:(",favStored=JSON.parse(localStorage.getItem("Anime favorites")||"[]");let animes=[];function handleInput(e){e.preventDefault(),animes=[],resultsList.innerHTML="Cargando...";const i=input.value.toLowerCase();fetch(`${apiURL}${i}`).then(e=>e.json()).then(e=>{animes=e.data,renderAnime()})}function renderAnime(){resultsList.innerHTML="";for(const e of animes){let i="";animeFavs.find(i=>i.mal_id===e.mal_id)&&(i="fav-res-background font-fav"),e.images.jpg.image_url===noImage?resultsList.innerHTML+=`\n        <li id="${e.mal_id}" class="list-item ${i} js_list_item">\n          ${e.title} \n          <img class="anime-image" src="${placeholderImage}">\n        </li>`:resultsList.innerHTML+=`\n      <li id="${e.mal_id}" class="list-item ${i} js_list_item">\n        ${e.title} \n        <img class="anime-image" src="${e.images.jpg.image_url}">\n      </li>`}listenerAnimes()}submitBtn.addEventListener("click",handleInput);let animeFavs=[];function handleClick(e){const i=parseInt(e.currentTarget.id),n=animes.find(e=>e.mal_id===i),a=animeFavs.findIndex(e=>e.mal_id===i);-1===a?animeFavs.push(n):animeFavs.splice(a,1),renderFavorites(),favStorage()}function renderFavorites(){favoritesList.innerHTML="";for(const e of animeFavs)e.images.jpg.image_url===noImage?favoritesList.innerHTML+=`\n        <li id="${e.mal_id}" \n        class="fav-list-item js_fav_list_item"></i>\n        ${e.title} \n        <i class="icon-heart fa-solid fa-heart"></i>\n        <i class="icon-cancel fa-solid fa-heart-circle-xmark"></i>\n        <img class="anime-image" \n        src="${placeholderImage}">\n        </li>`:favoritesList.innerHTML+=`\n        <li id="${e.mal_id}" \n        class="fav-list-item js_fav_list_item"></i>\n        ${e.title} \n        <i class="icon-heart fa-solid fa-heart"></i>\n        <i class="icon-cancel fa-solid fa-heart-circle-xmark"></i>\n        <img class="anime-image" \n        src="${e.images.jpg.image_url}">\n        </li>`;renderAnime(),listenerFavAnimes()}function listenerAnimes(){const e=document.querySelectorAll(".js_list_item");for(const i of e)i.addEventListener("click",handleClick)}function listenerFavAnimes(){const e=document.querySelectorAll(".js_fav_list_item");for(const i of e)i.addEventListener("click",handleClick)}function favStorage(){localStorage.setItem("Anime favorites",JSON.stringify(animeFavs))}function favDisplay(){if(animeFavs=favStored,favStored&&""!==favStored)for(const e of favStored)e.images.jpg.image_url===noImage?favoritesList.innerHTML+=`\n          <li id="${e.mal_id}" \n          class="fav-list-item js_fav_list_item"></i>\n          ${e.title} \n          <i class="icon-heart fa-solid fa-heart"></i>\n          <i class="icon-cancel fa-solid fa-heart-circle-xmark"></i>\n          <img class="anime-image" \n          src="${placeholderImage}">\n          </li>`:favoritesList.innerHTML+=`\n          <li id="${e.mal_id}" \n          class="fav-list-item js_fav_list_item"></i>\n          ${e.title} \n          <i class="icon-heart fa-solid fa-heart"></i>\n          <i class="icon-cancel fa-solid fa-heart-circle-xmark"></i>\n          <img class="anime-image" \n          src="${e.images.jpg.image_url}">\n          </li>`;else renderFavorites();listenerFavAnimes()}function handleResetClick(){resultsList.innerHTML="",input.value=""}favDisplay(),resetBtn.addEventListener("click",handleResetClick);const resetFavsBtn=document.querySelector(".js_reset_favs_btn");function handleResetFavsClick(){animeFavs=[],favoritesList.innerHTML="",localStorage.removeItem("Anime favorites"),renderAnime()}resetFavsBtn.addEventListener("click",handleResetFavsClick);